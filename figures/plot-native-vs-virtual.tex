\begin{figure}[!htb]
\begin{center}
\begin{tikzpicture}

\begin{axis} [name=plot1, height=\figheight, width=\figwidth, ybar=\ybarSepVO, enlarge y limits={upper,value=0.3},  
			ymin=0,
			legend pos=north east, legend columns=-1,
            ylabel={worst-case interrupt latency ($\mu{}s$)}, 
		    bar width=\ybarWidthVO,
			x=\ybarXdistVO,
            symbolic x coords={no load, cache\_pressure,forkops, fileops, hackbench, mmapops, stdout, threadops, all benchmarks},
            xtick=data, nodes near coords, nodes near coords align={vertical}, nodes near coords style={font=\ttfamily\scriptsize},
			x tick label style={rotate=25,anchor=east, font=\ttfamily\small}, ]                    
	\addplot [fill=yellow!20, postaction={pattern=north east lines}, pattern color=gray] coordinates {
				(no load, 67.6)				
				(cache\_pressure, 73.7)
				(forkops, 25.9)
				(fileops, 24.7)
				(hackbench, 9.3)
				(mmapops, 23.4)
				(stdout, 25.8)
				(threadops, 12.4)
				(all benchmarks, 19.8)
			      };

	\addplot [fill=NavyBlue!40] coordinates {
				(no load, 130.8)				
				(cache\_pressure, 141.7)
				(forkops, 119.5)
				(fileops, 146.4)
				(hackbench, 106.7)
				(mmapops, 106.6)
				(stdout, 142.7)
				(threadops, 169.1)
				(all benchmarks, 114.1)
			      };
\legend{native setup, virtual setup}
\end{axis}

%%%%%%%%%%%%%%%%%%for defense presentation%%%%%%%%%%%%%%%%%%%%
\ifdefense

\end{tikzpicture}
\end{center}
\label{plot-native-vs-virtual1}
\end{figure}
	
\begin{figure}[!htb]
\begin{center}
\begin{tikzpicture}

\fi
%%%%%%%%%%%%%%%%%%%%%ENDIF%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{axis} [name=plot2,\atCmdVOverheadLowerPlot,  height=\figheight, width=\figwidth, ybar=\ybarSepVO, enlarge y limits={upper,value=0.2}, 
				ymin=0,
                legend pos=north east, legend columns=-1,
                ylabel={average-case interrupt latency ($\mu{}s$)}, 
		       	bar width=\ybarWidthVO,
				x=\ybarXdistVO,
				symbolic x coords={no load, cache\_pressure,forkops, fileops, hackbench, mmapops, stdout, threadops, all benchmarks},
                xtick=data, nodes near coords, nodes near coords align={vertical},  nodes near coords style={font=\ttfamily\scriptsize},
				 x tick label style={rotate=25,anchor=east, font=\ttfamily\small}, ]                    
	\addplot [fill=yellow!20, postaction={pattern=north east lines}, pattern color=gray] coordinates {
				(no load, 44.2)				
				(cache\_pressure, 43.1)
				(forkops, 6.1)
				(fileops, 6.1)
				(hackbench, 4.5)
				(mmapops, 4.4)
				(stdout, 6.1)
				(threadops, 5)
				(all benchmarks, 4.9)
			      };
	\addplot [fill=NavyBlue!40] coordinates {
				(no load, 18.2)				
				(cache\_pressure, 26.6)
				(forkops, 12.6)
				(fileops, 14.3)
				(hackbench, 10)
				(mmapops, 8.1)
				(stdout, 14.9)
				(threadops, 16.4)
				(all benchmarks, 10.2)
			      };
\legend{native setup, virtual setup}
\end{axis}

\end{tikzpicture}
\end{center}
\ifreport
\caption{Comparison of worst-case and average-case latency in native and virtual setup}
\label{plot-native-vs-virtual}
\else
\label{plot-native-vs-virtual2}
\fi
\end{figure}
